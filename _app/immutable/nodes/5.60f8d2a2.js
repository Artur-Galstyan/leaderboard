import{S as ze,i as Ye,s as Je,a as T,k as y,q as te,y as oe,c as B,l as k,m as C,h as r,r as le,W as Me,z as ne,n as c,X as _e,R as de,b as v,C as g,A as ie,D as we,d as x,f as Xe,g as ee,B as re,G as qe,H as se,o as Ge,J as Y,Y as Ke,Z as He,e as Re,_ as Ue,v as We,w as Ie,O as Ne,P as ge,F as fe}from"../chunks/index.487cb5f4.js";import{p as Ze}from"../chunks/stores.7e35c888.js";import{A as Qe,a as $e,b as xe,c as et,S as tt,j as lt,e as ye,p as Le,f as at,k as st,m as Ae,g as ke,D as ot,n as nt}from"../chunks/tabulator_esm.af70a705.js";import{a as G,c as $,n as De,l as Se,t as be,i as it,b as rt}from"../chunks/lastParsedTable.8a939b49.js";import{m as Ve}from"../chunks/marked.esm.8a49593e.js";import{f as he}from"../chunks/index.c71e4220.js";const{document:Te}=Ke;function dt(i){let s,a,e,o,n,w,b,E=i[2]&&!i[2].includes("404"),R,I,D,U,P,H=i[10]&&i[10].newLeaderboards.find(i[15])!=null,M,S,q,V=i[10]&&i[10].newColumns.find(i[14])!=null,j,A,K,W;a=new ot({props:{datasetName:null}});let N=i[1]&&i[0]&&Be(),_=E&&Fe(i);function Q(d,l){return d[0]==null?mt:ut}let z=Q(i),F=z(i),h=H&&Pe(i),L=V&&je();return{c(){s=y("div"),oe(a.$$.fragment),e=T(),N&&N.c(),o=T(),n=y("div"),w=T(),b=y("div"),_&&_.c(),I=T(),D=y("div"),U=y("div"),F.c(),P=T(),h&&h.c(),M=T(),S=y("input"),q=T(),L&&L.c(),this.h()},l(d){s=k(d,"DIV",{class:!0});var l=C(s);ne(a.$$.fragment,l),e=B(l),N&&N.l(l),o=B(l),n=k(l,"DIV",{class:!0}),C(n).forEach(r),w=B(l),b=k(l,"DIV",{class:!0});var f=C(b);_&&_.l(f),f.forEach(r),l.forEach(r),I=B(d),D=k(d,"DIV",{id:!0,class:!0});var m=C(D);U=k(m,"DIV",{class:!0});var p=C(U);F.l(p),p.forEach(r),P=B(m),h&&h.l(m),M=B(m),S=k(m,"INPUT",{type:!0,class:!0,placeholder:!0,name:!0,id:!0}),q=B(m),L&&L.l(m),m.forEach(r),this.h()},h(){c(n,"class","divider w-[50%] mx-auto"),c(b,"class","prose text-justify mx-auto"),c(s,"class",""),c(U,"class","font-bold my-auto mx-20 text-2xl"),c(S,"type","text"),c(S,"class","input input-primary input-sm w-60 my-auto"),c(S,"placeholder","Filter ðŸ”Ž"),c(S,"name","filter"),c(S,"id","filter"),de(S,"hidden",i[0]==null),c(D,"id","leaderboard-header"),c(D,"class","flex justify-center my-4")},m(d,l){v(d,s,l),ie(a,s,null),g(s,e),N&&N.m(s,null),g(s,o),g(s,n),g(s,w),g(s,b),_&&_.m(b,null),v(d,I,l),v(d,D,l),g(D,U),F.m(U,null),g(D,P),h&&h.m(D,null),g(D,M),g(D,S),i[18](S),g(D,q),L&&L.m(D,null),A=!0,K||(W=we(S,"input",i[11]),K=!0)},p(d,l){d[1]&&d[0]?N||(N=Be(),N.c(),N.m(s,o)):N&&(N.d(1),N=null),l&4&&(E=d[2]&&!d[2].includes("404")),E?_?_.p(d,l):(_=Fe(d),_.c(),_.m(b,null)):_&&(_.d(1),_=null),z===(z=Q(d))&&F?F.p(d,l):(F.d(1),F=z(d),F&&(F.c(),F.m(U,null))),l&1536&&(H=d[10]&&d[10].newLeaderboards.find(d[15])!=null),H?h?h.p(d,l):(h=Pe(d),h.c(),h.m(D,M)):h&&(h.d(1),h=null),(!A||l&1)&&de(S,"hidden",d[0]==null),l&1536&&(V=d[10]&&d[10].newColumns.find(d[14])!=null),V?L||(L=je(),L.c(),L.m(D,null)):L&&(L.d(1),L=null)},i(d){A||(ee(a.$$.fragment,d),d&&Ne(()=>{A&&(R||(R=ge(s,he,{},!0)),R.run(1))}),d&&Ne(()=>{A&&(j||(j=ge(D,he,{},!0)),j.run(1))}),A=!0)},o(d){x(a.$$.fragment,d),d&&(R||(R=ge(s,he,{},!1)),R.run(0)),d&&(j||(j=ge(D,he,{},!1)),j.run(0)),A=!1},d(d){d&&r(s),re(a),N&&N.d(),_&&_.d(),d&&R&&R.end(),d&&r(I),d&&r(D),F.d(),h&&h.d(),i[18](null),L&&L.d(),d&&j&&j.end(),K=!1,W()}}}function ft(i){let s,a,e;return{c(){s=y("div"),a=y("div"),e=y("span"),this.h()},l(o){s=k(o,"DIV",{class:!0});var n=C(s);a=k(n,"DIV",{class:!0});var w=C(a);e=k(w,"SPAN",{class:!0}),C(e).forEach(r),w.forEach(r),n.forEach(r),this.h()},h(){c(e,"class","loading loading-infinity loading-lg text-primary"),c(a,"class","flex justify-center"),c(s,"class","h-screen w-screen flex flex-col justify-center")},m(o,n){v(o,s,n),g(s,a),g(a,e)},p:fe,i:fe,o:fe,d(o){o&&r(s)}}}function Be(i){let s,a,e;return{c(){s=y("main"),a=y("h1"),e=te("Dataset: Systems"),this.h()},l(o){s=k(o,"MAIN",{class:!0});var n=C(s);a=k(n,"H1",{});var w=C(a);e=le(w,"Dataset: Systems"),w.forEach(r),n.forEach(r),this.h()},h(){c(s,"class","prose text-justify mx-auto mt-16")},m(o,n){v(o,s,n),g(s,a),g(a,e)},d(o){o&&r(s)}}}function Fe(i){let s,a,e;return{c(){s=new He(!1),a=T(),e=y("div"),this.h()},l(o){s=Ue(o,!1),a=B(o),e=k(o,"DIV",{class:!0}),C(e).forEach(r),this.h()},h(){s.a=a,c(e,"class","divider w-[50%] mx-auto")},m(o,n){s.m(i[2],o,n),v(o,a,n),v(o,e,n)},p(o,n){n&4&&s.p(o[2])},d(o){o&&s.d(),o&&r(a),o&&r(e)}}}function ut(i){let s;return{c(){s=te("Leaderboard")},l(a){s=le(a,"Leaderboard")},m(a,e){v(a,s,e)},p:fe,d(a){a&&r(s)}}}function mt(i){let s,a,e,o,n,w;return{c(){s=te(`No Leaderboard for this dataset yet

				`),a=y("div"),e=y("button"),o=te("Submit a new leaderboard"),this.h()},l(b){s=le(b,`No Leaderboard for this dataset yet

				`),a=k(b,"DIV",{class:!0});var E=C(a);e=k(E,"BUTTON",{class:!0});var R=C(e);o=le(R,"Submit a new leaderboard"),R.forEach(r),E.forEach(r),this.h()},h(){c(e,"class","btn btn-accent btn-wide"),c(a,"class","flex justify-center")},m(b,E){v(b,s,E),v(b,a,E),g(a,e),g(e,o),n||(w=we(e,"click",i[16]),n=!0)},p:fe,d(b){b&&r(s),b&&r(a),n=!1,w()}}}function Pe(i){let s,a,e,o,n;return{c(){s=y("div"),a=y("button"),e=te("Delete"),this.h()},l(w){s=k(w,"DIV",{class:!0});var b=C(s);a=k(b,"BUTTON",{class:!0});var E=C(a);e=le(E,"Delete"),E.forEach(r),b.forEach(r),this.h()},h(){c(a,"class","btn btn-warning"),c(s,"class","my-auto mx-4")},m(w,b){v(w,s,b),g(s,a),g(a,e),o||(n=we(a,"click",i[17]),o=!0)},p:fe,d(w){w&&r(s),o=!1,n()}}}function je(i){let s,a;return{c(){s=y("div"),a=te("Right click on your new column to delete it"),this.h()},l(e){s=k(e,"DIV",{class:!0});var o=C(s);a=le(o,"Right click on your new column to delete it"),o.forEach(r),this.h()},h(){c(s,"class","mx-4 italic text-xs my-auto text-gray-400")},m(e,o){v(e,s,o),g(s,a)},d(e){e&&r(s)}}}function Oe(i){let s,a;return{c(){s=new He(!1),a=Re(),this.h()},l(e){s=Ue(e,!1),a=Re(),this.h()},h(){s.a=a},m(e,o){s.m(i[3],e,o),v(e,a,o)},p(e,o){o&8&&s.p(e[3])},d(e){e&&r(a),e&&s.d()}}}function ct(i){let s,a,e,o,n,w,b,E,R,I,D,U,P,H,M,S,q,V,j,A,K,W,N,_,Q,z,F,h,L,d,l,f,m,p,J;const Z=[ft,dt],X=[];function ve(t,u){return t[6]?0:1}s=ve(i),a=X[s]=Z[s](i);let O=i[3]&&Oe(i);return _=new Qe({props:{dataset:i[9].params.db+"/"+i[9].params.dataset}}),z=new $e({props:{dataset:i[9].params.db+"/"+i[9].params.dataset}}),h=new xe({props:{dataset:i[9].params.db+"/"+i[9].params.dataset}}),d=new et({props:{dataset:i[9].params.db+"/"+i[9].params.dataset}}),f=new tt({}),{c(){a.c(),e=T(),o=y("div"),n=y("div"),w=y("div"),b=T(),E=y("div"),R=y("button"),I=te("+"),U=T(),P=y("div"),H=y("button"),M=te("+"),q=T(),V=y("div"),O&&O.c(),j=T(),A=y("div"),K=T(),W=y("link"),N=T(),oe(_.$$.fragment),Q=T(),oe(z.$$.fragment),F=T(),oe(h.$$.fragment),L=T(),oe(d.$$.fragment),l=T(),oe(f.$$.fragment),this.h()},l(t){a.l(t),e=B(t),o=k(t,"DIV",{id:!0,class:!0});var u=C(o);n=k(u,"DIV",{class:!0});var ae=C(n);w=k(ae,"DIV",{}),C(w).forEach(r),ae.forEach(r),b=B(u),E=k(u,"DIV",{class:!0});var ue=C(E);R=k(ue,"BUTTON",{class:!0});var me=C(R);I=le(me,"+"),me.forEach(r),ue.forEach(r),u.forEach(r),U=B(t),P=k(t,"DIV",{class:!0});var ce=C(P);H=k(ce,"BUTTON",{class:!0});var pe=C(H);M=le(pe,"+"),pe.forEach(r),ce.forEach(r),q=B(t),V=k(t,"DIV",{class:!0});var Ce=C(V);O&&O.l(Ce),Ce.forEach(r),j=B(t),A=k(t,"DIV",{class:!0}),C(A).forEach(r),K=B(t);const Ee=Me("svelte-1256386",Te.head);W=k(Ee,"LINK",{href:!0,rel:!0}),Ee.forEach(r),N=B(t),ne(_.$$.fragment,t),Q=B(t),ne(z.$$.fragment,t),F=B(t),ne(h.$$.fragment,t),L=B(t),ne(d.$$.fragment,t),l=B(t),ne(f.$$.fragment,t),this.h()},h(){c(n,"class","overflow-x-scroll w-full"),c(R,"class","btn btn-secondary h-full"),c(E,"class","mx-2 flex items-center justify-center bg-reg-400"),c(o,"id","leaderboard-wrapper"),c(o,"class",D=_e(`w-[80%] mx-auto ${i[7]} flex`)+" svelte-1w85bai"),de(o,"hidden",i[0]==null||i[8]==null),c(H,"class","btn btn-primary w-full"),c(P,"class",S=_e(`my-2 w-[80%] mx-auto ${i[7]}`)+" svelte-1w85bai"),de(P,"hidden",i[0]==null),c(V,"class","prose text-justify mx-auto"),c(A,"class","my-20"),c(W,"href","https://unpkg.com/tabulator-tables@5.5.0/dist/css/tabulator_bootstrap5.min.css"),c(W,"rel","stylesheet")},m(t,u){X[s].m(t,u),v(t,e,u),v(t,o,u),g(o,n),g(n,w),i[19](w),g(o,b),g(o,E),g(E,R),g(R,I),v(t,U,u),v(t,P,u),g(P,H),g(H,M),v(t,q,u),v(t,V,u),O&&O.m(V,null),v(t,j,u),v(t,A,u),v(t,K,u),g(Te.head,W),v(t,N,u),ie(_,t,u),v(t,Q,u),ie(z,t,u),v(t,F,u),ie(h,t,u),v(t,L,u),ie(d,t,u),v(t,l,u),ie(f,t,u),m=!0,p||(J=[we(R,"click",i[12]),we(H,"click",i[13])],p=!0)},p(t,[u]){let ae=s;s=ve(t),s===ae?X[s].p(t,u):(We(),x(X[ae],1,1,()=>{X[ae]=null}),Xe(),a=X[s],a?a.p(t,u):(a=X[s]=Z[s](t),a.c()),ee(a,1),a.m(e.parentNode,e)),(!m||u&128&&D!==(D=_e(`w-[80%] mx-auto ${t[7]} flex`)+" svelte-1w85bai"))&&c(o,"class",D),(!m||u&385)&&de(o,"hidden",t[0]==null||t[8]==null),(!m||u&128&&S!==(S=_e(`my-2 w-[80%] mx-auto ${t[7]}`)+" svelte-1w85bai"))&&c(P,"class",S),(!m||u&129)&&de(P,"hidden",t[0]==null),t[3]?O?O.p(t,u):(O=Oe(t),O.c(),O.m(V,null)):O&&(O.d(1),O=null);const ue={};u&512&&(ue.dataset=t[9].params.db+"/"+t[9].params.dataset),_.$set(ue);const me={};u&512&&(me.dataset=t[9].params.db+"/"+t[9].params.dataset),z.$set(me);const ce={};u&512&&(ce.dataset=t[9].params.db+"/"+t[9].params.dataset),h.$set(ce);const pe={};u&512&&(pe.dataset=t[9].params.db+"/"+t[9].params.dataset),d.$set(pe)},i(t){m||(ee(a),ee(_.$$.fragment,t),ee(z.$$.fragment,t),ee(h.$$.fragment,t),ee(d.$$.fragment,t),ee(f.$$.fragment,t),m=!0)},o(t){x(a),x(_.$$.fragment,t),x(z.$$.fragment,t),x(h.$$.fragment,t),x(d.$$.fragment,t),x(f.$$.fragment,t),m=!1},d(t){X[s].d(t),t&&r(e),t&&r(o),i[19](null),t&&r(U),t&&r(P),t&&r(q),t&&r(V),O&&O.d(),t&&r(j),t&&r(A),t&&r(K),r(W),t&&r(N),re(_,t),t&&r(Q),re(z,t),t&&r(F),re(h,t),t&&r(L),re(d,t),t&&r(l),re(f,t),p=!1,qe(J)}}}function pt(i,s,a){let e,o,n,w,b,E;se(i,G,l=>a(8,e=l)),se(i,Ze,l=>a(9,o=l)),se(i,$,l=>a(10,n=l)),se(i,Ae,l=>a(22,w=l)),se(i,nt,l=>a(23,b=l)),se(i,Se,l=>a(24,E=l));const{Tabulator:R}=st;let I,D,U,P,H=!1,M=!1;function S(l){let f=l.target.value,m=e==null?void 0:e.getColumns().map(p=>p.getField());f&&e?e.setFilter([[],[m==null?void 0:m.map(p=>({field:p,type:"like",value:f}))]]):e?e.clearFilter(!0):console.error("Tabulator not initialized")}function q(){if(!e){De("Tabulator not initialized","Failed to set event listeners");return}e.on("tableBuilding",()=>{H=!0,M=!1,console.log("Table building")}),e.on("tableBuilt",async()=>{M=!0,H=!1,e&&(console.log("Table loaded, setting lastParsedTable",e.getRows()),Y(Se,E=e.getRows().map(l=>JSON.parse(JSON.stringify(l.getData()))),E)),console.log("Table built"),n&&(console.log("Applying changes from loaded PR"),n.newColumns.length>0&&(console.log("Applying columns"),n.newColumns.forEach(l=>{_(l)})),n.newRows.length>0&&(console.log("Applying rows"),n.newRows.forEach(async l=>{if(l.dataset!=o.params.db+"/"+o.params.dataset)return;console.log("Adding row",l.row);let f=await(e==null?void 0:e.addRow(l.row));if(f){if(b.find(p=>p.getIndex()==(f==null?void 0:f.getIndex())))return;b.push(f)}e==null||e.redraw(!0),G.set(e)})),n.changedRows&&(n==null?void 0:n.changedRows.length)>0&&n.changedRows.forEach(l=>{l.dataset==o.params.db+"/"+o.params.dataset&&(console.log("Applying changed cells"),e==null||e.getRows().forEach(async f=>{f.getIndex()==l.row.id&&(await f.update(l.row),l.row=f.getData())}),e==null||e.redraw(!0),G.set(e))})),G.set(e)}),e.on("rowDblClick",(l,f)=>{Y(Ae,w=f,w),be("show-row-dialog")}),e.on("cellEdited",function(l){n||Y($,n=it(),n),n.changedRows==null&&Y($,n.changedRows=[],n),console.log("Adding row to 'changedRows'",l.getRow());let f=n.changedRows.find(m=>m.row.id==l.getRow().getIndex());if(f){console.log("Row already in changes, updating"),f.row=l.getRow().getData(),Y($,n.lastChange="cell",n);return}else console.log("Row not in changes, adding"),n.changedRows.push({dataset:o.params.db+"/"+o.params.dataset,row:l.getRow().getData()}),Y($,n.lastChange="cell",n)}),e.on("headerContext",async function(l,f){if(l.preventDefault(),!(n==null?void 0:n.newColumns.find(J=>J.column==f.getField())))return;let p=document.createElement("button");p.id="delete-column-button",p.innerHTML="Delete column",p.classList.add("btn","btn-error","absolute"),p.style.top=l.clientY+window.scrollY+"px",p.style.left=l.clientX+window.scrollX+"px",p.onclick=async()=>{if(n)e==null||e.hideColumn(f.getField()),await f.delete(),Y($,n.lastChange=null,n),Y($,n.newColumns=n.newColumns.filter(J=>J.column!=f.getField()),n),rt("Column deleted","Column deleted successfully"),p.remove();else{De("Couldn't delete column","No PR changes found"),p.remove();return}},document.body.appendChild(p)})}let V,j,A=!0,K="";Ge(async()=>{document.body.onclick=f=>{var m;(m=document.getElementById("delete-column-button"))==null||m.remove()},Y(G,e=null,e);const l=await lt();if(console.log(l),a(0,I=l.parsedTable),a(1,D=l.prefaceData),a(2,U=l.parsedInfo),a(3,P=l.parsedFooter),a(7,K="fade-in"),I){let f=ke();f=ye(I,f);try{Y(G,e=new R(V,{data:I,layout:"fitColumns",height:"500",reactiveData:!0,columns:f,movableColumns:!0}),e),q()}catch{console.log("some error occured while loading table's data; likely got cancelled"),Y(G,e=null,e)}}else if(n){let f=n;if(f.newLeaderboards.find(p=>p.dataset=="systems")){console.log("Leaderboard found in pr changes cookie");const p=Ve.parse(f.newLeaderboards[f.newLeaderboards.length-1].data,{mangle:!1,headerIds:!1});if(a(0,I=Le(p).results[0]),I!=null){console.log("Table found in pr changes cookie");let J=ke();J=ye(I,J);try{Y(G,e=new R(V,{data:I,layout:"fitColumns",height:"500",reactiveData:!0,columns:J,movableColumns:!0}),e),q()}catch{console.log("some error occured while loading table's data; likely got cancelled"),Y(G,e=null,e)}}else console.log("No table found")}else{De("No leaderboard found","There is no leaderboard for this dataset"),a(6,A=!1),H=!1,M=!1;return}a(6,A=!1)}else console.log("No table found");a(6,A=!1)});function W(){be(`add-new-column-${o.params.db}/${o.params.dataset}`)}function N(){be(`add-new-row-${o.params.db}/${o.params.dataset}`)}$.subscribe(l=>{if(l){if(l.lastChange==="column"){let f=l.newColumns[l.newColumns.length-1];console.log("Adding new column",f),_(f)}else if(l.lastChange==="leaderboard"){const f=Ve.parse(l.newLeaderboards[l.newLeaderboards.length-1].data,{mangle:!1,headerIds:!1});if(a(0,I=Le(f).results[0]),I){let m=ke();m=ye(I,m);try{Y(G,e=new R(V,{data:I,layout:"fitColumns",height:"500",reactiveData:!0,columns:m,movableColumns:!0}),e),q()}catch{console.log("some error occured while loading table's data; likely got cancelled"),Y(G,e=null,e)}}else console.log("No table found - from currentPRChanges subscription");a(6,A=!1)}l.lastChange!==null&&at(l),M&&!H&&(e==null||e.redraw(!0)),G.set(e)}});function _(l){if(l==null){console.log("no column provided, likely due to column deletion. Not adding column to table");return}if(l.dataset!=o.params.db+"/"+o.params.dataset)return;let f=l.column,m=l.numerical,p={title:f,field:f,resizable:!0,editor:"input"};m&&(p.sorter=function(Z,X,ve,O,t,u,ae){return Z=="-"&&(Z=0),X=="-"&&(X=0),Z-X}),e==null||e.addColumn(p);let J=e==null?void 0:e.getRows();if(J){for(let Z=0;Z<J.length;Z++)J[Z].update({[f]:"-"});e==null||e.redraw(!0)}}const Q=l=>l.dataset===`${o.params.db}/${o.params.dataset}`,z=l=>l.dataset===`${o.params.db}/${o.params.dataset}`,F=()=>{be(`add-new-leaderboard-${o.params.db}/${o.params.dataset}`)},h=()=>{be("delete-new-leaderboard-"+o.params.db+"/"+o.params.dataset)};function L(l){Ie[l?"unshift":"push"](()=>{j=l,a(5,j)})}function d(l){Ie[l?"unshift":"push"](()=>{V=l,a(4,V)})}return[I,D,U,P,V,j,A,K,e,o,n,S,W,N,Q,z,F,h,L,d]}class yt extends ze{constructor(s){super(),Ye(this,s,pt,ct,Je,{})}}export{yt as component};
